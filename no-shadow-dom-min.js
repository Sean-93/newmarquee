const RTL_LANGUAGES=["ar","he","fa","ur","yi","ps","dv","ug","syr"];class Marquee{constructor(e){this.container=e,this.marqueeContent=e.querySelector("#marquee-content"),this.currentAnimation=null,this.progressUpdateInterval=null,this.resizeListener=null,this.languageChangeTimeout=null,this.ensureImagesLoaded(()=>{this.setDefaultDirection(),this.animateMarquee(),this.resizeListener=this.animateMarquee.bind(this),window.addEventListener("resize",this.resizeListener),"true"===this.container.dataset.pauseonhover&&this.addHoverListeners()}),this.observer=new MutationObserver(()=>{this.languageChangeTimeout&&clearTimeout(this.languageChangeTimeout),this.languageChangeTimeout=setTimeout(()=>this.setDefaultDirection(),100)}),this.observer.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]})}ensureImagesLoaded(e){let t=this.container.querySelectorAll("img"),n=Array.from(t).map(e=>new Promise(t=>{e.complete&&0!==e.naturalHeight?t():e.addEventListener("load",t,{once:!0})}));Promise.all(n).then(e).catch(e=>{console.error("Error loading images:",e)})}setDefaultDirection(){let e=document.documentElement.lang,t=this.container.dataset.direction;!RTL_LANGUAGES.includes(e)||t&&["left","right","up","down"].includes(t)||(this.container.dataset.direction="right")}animateMarquee(){let e=this.marqueeContent.scrollWidth,t=this.marqueeContent.scrollHeight,n=this.container.offsetWidth,i=this.container.offsetHeight,r=parseInt(this.container.dataset.speed,10)||50,s=this.container.dataset.direction||"left",a="true"===this.container.dataset.persistent?.trim().toLowerCase(),o=`${this.container.id||"marquee"}-state`,u=0,h=0;if(a){let m;try{(m=localStorage.getItem(o))&&(m=JSON.parse(m))}catch(l){console.error("Error parsing saved state:",l),m=null}m&&(u=parseFloat(m.time),h=parseFloat(m.timestamp))}let c,d;switch(s){case"right":c=e/r,d=[{transform:`translateX(-${e}px)`},{transform:`translateX(${n}px)`}];break;case"up":c=t/r,d=[{transform:`translateY(${i}px)`},{transform:`translateY(-${t}px)`}];break;case"down":c=t/r,d=[{transform:`translateY(-${t}px)`},{transform:`translateY(${i}px)`}];break;default:c=e/r,d=[{transform:`translateX(${n}px)`},{transform:`translateX(-${e}px)`}]}let p=this.marqueeContent.animate(d,{duration:1e3*c,iterations:1/0});if(a){if(isFinite(u)){let g=Date.now(),v=Math.max(0,g-h),$=(u+v)%(1e3*c);p.currentTime=$}let f,L=(f=0,()=>{let e=Date.now();if(e-f>=Math.min(100*c,1e3)){f=e;let t=p.currentTime%(1e3*c);localStorage.setItem(o,JSON.stringify({time:t,timestamp:Date.now()}))}});this.progressUpdateInterval=setInterval(L,500)}this.currentAnimation=p}addHoverListeners(){this.pauseAnimation=()=>{this.currentAnimation&&this.currentAnimation.pause()},this.resumeAnimation=()=>{this.currentAnimation&&this.currentAnimation.play()},this.marqueeContent.addEventListener("mouseenter",this.pauseAnimation),this.marqueeContent.addEventListener("mouseleave",this.resumeAnimation)}removeHoverListeners(){this.marqueeContent.removeEventListener("mouseenter",this.pauseAnimation),this.marqueeContent.removeEventListener("mouseleave",this.resumeAnimation)}destroy(){this.resizeListener&&window.removeEventListener("resize",this.resizeListener),"true"===this.container.dataset.pauseonhover&&this.removeHoverListeners(),this.currentAnimation&&(this.currentAnimation.cancel(),this.currentAnimation=null),this.progressUpdateInterval&&clearInterval(this.progressUpdateInterval),this.observer&&this.observer.disconnect()}}function initializeMarquees(){document.querySelectorAll(".marquee-container").forEach(e=>{new Marquee(e)})}document.addEventListener("DOMContentLoaded",initializeMarquees);